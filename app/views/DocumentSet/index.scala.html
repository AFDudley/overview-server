@(
  user: OverviewUser,
  documentSets: ResultPage[OverviewDocumentSet],
  jobsWithDocumentSets: ResultPage[(OverviewDocumentSetCreationJob,OverviewDocumentSet)],
  form: controllers.forms.DocumentSetForm.FormType
)(implicit lang: Lang, flash: Flash)

@javascripts = {
  <!--[if IE 9]>
    @bundleJavascript("silverlight-upload-request")
  <![endif]-->

  @bundleJavascript("document-set-index")
}

@jsMessageKeys = @{Seq(
  "views.DocumentSet._dcimport.legend",
  "views.DocumentSet._dcimport.error",
  "views.DocumentSet._dcimport.labels.email",
  "views.DocumentSet._dcimport.labels.password",
  "views.DocumentSet._dcimport.placeholders.email",
  "views.DocumentSet._dcimport.submit",
  "views.DocumentSet._dcimport.explanation",
  "views.DocumentSet._dcimport.explanation_no_cors",
  "views.DocumentSet._uploadForm.error.SyntaxError",
  "views.DocumentSet._uploadForm.leavePageWarning",
  "views.DocumentSet._documentSet.action_import",
  "views.DocumentSet._documentSet.document_count"
)}

@**** Stupid function needed only because I can't figure out how to pass 2 params in the map call ****@
@displayDocumentSet(documentSet: OverviewDocumentSet) = {
  @views.html.DocumentSet._documentSet(documentSet, user)
}

@defining(scopedMessages("views.DocumentSet.index")) { m =>
  @main(optionalUser=Some(user), title=m("title"), bodyClass="document-set-index", h1=m("h1"), javascripts=javascripts, jsMessageKeys=jsMessageKeys) {
    @views.html.DocumentSet._import(user, form)

    @if(jobsWithDocumentSets) {
      <div class="document-set-creation-jobs" data-refresh-url="@routes.DocumentSetCreationJobController.index().url" data-document-set-url-pattern="@routes.DocumentSetController.showJson(0).url">
        <h2>@m("subtitle_jobs")</h2>
        <p class="description">@m("description_jobs")</p>
        <ul class="unstyled">
          @jobsWithDocumentSets.map { tuple: (OverviewDocumentSetCreationJob,OverviewDocumentSet) =>
            @views.html.DocumentSetCreationJob._documentSetCreationJob(tuple._1, tuple._2)
          }
        </ul>
      </div>
    }

    @if(documentSets || jobsWithDocumentSets) {
      <div class="document-sets">
        <ul class="unstyled">
          @documentSets.map(displayDocumentSet(_))
        </ul>
        @if(documentSets) {
          @helper.Pagination.links(documentSets.pageDetails, (pageNum: Int) => routes.DocumentSetController.index(pageNum).url)
        } else {
          <p class="no-document-sets">@m("no_document_sets")</p>
        }
      </div>

      <div style="display:none;">
        @views.html.DocumentSet._errorList()
      </div>
    }
  }
}
