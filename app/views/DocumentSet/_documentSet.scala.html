@(
  documentSet: OverviewDocumentSet
)(implicit lang: play.api.i18n.Lang)

@import views.helper.DocumentSetHelper

@defining(scopedMessages("views.DocumentSet._documentSet")) { m =>
  <li id="document-set-@documentSet.id" class="@(documentSet.creationJob.map(j => "unfinished"))">
    <form method="post" class="delete form-inline" data-confirm="@m("confirm_delete")" action="@routes.DocumentSetController.delete(documentSet.id)?X-HTTP-Method-Override=DELETE">
      <input type="submit" class="btn btn-danger" value="@m("action_delete")" />
    </form>
    <form method="post" class="update form-inline" action="@routes.DocumentSetController.update(documentSet.id)?X-HTTP-Method-Override=PUT">
      <label>
        <input type="checkbox" name="public" value="true"@{if (documentSet.isPublic) Html(" checked=\"checked\"") else ""} />
        <input type="hidden" name="public" value="false" />
        @m("toggle_public")
      </label>
    </form>
    <h2><a href="@routes.DocumentSetController.show(documentSet.id)">@documentSet.title</a></h2>
    <h3>
      @documentSet match {
        case ds: OverviewDocumentSet.DocumentCloudDocumentSet => {
          @m("subtitle.query", ds.query)
        }
        case _ => {
          @m("subtitle.other")
        }
      }
    </h3>
    <p class="status">
      @documentSet.creationJob.map { job =>
        <label>
          <progress min="0" max="100" value="@scala.math.round(job.fractionComplete * 100)"></progress><!-- IE9 needs start+end tags -->
          <span class="state">@t("models.DocumentSetCreationJob.state." + job.state.toString())</span>
        </label>
        <span class="state-description">@DocumentSetHelper.jobDescriptionMessage(job)</span>
      }.getOrElse {
        <span class="document-count">@m("document_count", documentSet.documentCount)</span>
      }
      @if(documentSet.errorCount > 0) {
        <a class="error-list" href="@routes.DocumentProcessingErrorController.index(documentSet.id)" data-toggle="modal" data-target="#error-list-modal">@m("error_count", documentSet.errorCount)</a>
      }
    </p>
  </li>
}
